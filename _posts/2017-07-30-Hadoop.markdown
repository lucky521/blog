---
title: "Hadoop使用手册"
categories: [design]
layout: post
---

# Hadoop是做什么的？ 

分布式。数据存储。数据处理。



# Linux下安装和启动Hadoop

### 添加用户和用户组

```
> sudo addgroup hadoop
> sudo adduser --ingroup hadoop hduser
```

### 开启ssh连接（要为Hadoop集群中的所有机器提供SSH授权）

```
> ssh hduser@localhost
```


### Disable IPV6
```
> sudo vim /etc/sysctl.conf
add 
# disable ipv6
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1
```

### 安装hadoop

```
> sudo add-apt-repository ppa:hadoop-ubuntu/stable 
> sudo apt-get update && sudo apt-get upgrade  
> sudo apt-get install hadoop
> man hadoop
```

### 设置环境变量

```
> sudo vim /home/hduser/.bashrc
# Set Hadoop-related environment variables   设置hadoop程序的路径，这样程序找自带jar包也容易。
export HADOOP_HOME=/usr/lib/hadoop 
# Set JAVA_HOME (we will also configure JAVA_HOME directly for Hadoop later on)  设置JDK的路径
export JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64
```

### 修改conf/hadoop-env.sh

```
$ sudo vim /etc/hadoop/conf/hadoop-env.sh
add 
export JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64
```

### 给HDFS文件系统创建一个目录

HDFS文件系统的权限属于hduser
```
$ sudo mkdir -p /app/hadoop/tmp
$ sudo chown hduser:hadoop /app/hadoop/tmp
# ...and if you want to tighten up security, chmod from 755 to 750...
$ sudo chmod 750 /app/hadoop/tmp
```

### 填写conf/core-site.xml

```
$ sudo vim /etc/hadoop/conf/core-site.xml
```
填写了hadoop.tmp.dir的path， fs.default.name的link

### 填写conf/mapred-site.xml

```
$ sudo vim /etc/hadoop/conf/mapred-site.xml
```
填写了mapred.job.tracker的link地址（唯一的JobTracker主服务器地址）

### 填写conf/hdfs-site.xml

```
$ sudo vim /etc/hadoop/conf/hdfs-site.xml
设置了dfs.replication的值为1。
```

### 格式化HDFS文件系统
以hduser的身份进行操作
```$ hadoop namenode -format``` 
这样就在/app/hadoop/tmp下创建了一个空的文件系统。

### 启动Hadoop
```> /usr/lib/hadoop/bin/start-all.sh```
这就会启动a Namenode, SecondaryNameNode, Datanode, Jobtracker and a Tasktracker

### 查看java 进程
```> jps```
看到5个进程都启动起来了。


# MacOSX下安装Hadoop

- 1、先安装java （上官网下载安装包）
- 2、已经自带了ssh。
打开hadoop的时候不要连接外网。连外网之后本机ip就变了。ssh到localhost出错。需要去System Preferences的Sharing里面手动允许22端口开放：http://stackoverflow.com/questions/6313929/how-do-i-open-port-22-in-osx-10-6-7
- 3、brew install hadoop 直接安装了1.2.1稳定版
	```hadoop version 查看版本号```
hadoop系统安装路径在
```/usr/local/Cellar/hadoop/1.2.1/```


## 填写配置文件：
三大配置文件，core-site.xml, hdfs-site.xml, mapred-site.xml (在0.2老版本中是三合一的一个xml)。要分别在里面填写name、jobtracker、replication的配置内容。

## 格式化一个新的文件系统（在hadoop所有进程关闭的时候运行这个）
```$ hadoop namenode -format```
默认情况下这个文件系统hdfs被放在本机的/tmp/hadoop-liulu/。对于hdfs本身来说，其中的文件被放在/user/liulu里面。


